<!doctype html>
<html>
<head>
  <title>Go Direct Sensor Readout</title>
  <meta name="description" content="Simple example of connecting to a Vernier Go DirectÂ® Sensor with WebBluetooth and logging out the default sensor value">
  <meta charset="utf-8">
  <script src="https://unpkg.com/@vernier/godirect/dist/godirect.min.umd.js"></script>
</head>

<body>
  <button id="select_device">Select Go Direct Device</button>
  <pre id="output"></pre> 
  <script>
    const selectDeviceBtn = document.querySelector('#select_device');
    const output = document.querySelector('#output');
    
    const selectDevice = async () => {
      try {
        const gdxDevice = await godirect.selectDevice();
        output.textContent += `\n Connected to `+gdxDevice.name;
        output.textContent += `\n Availiable sensors: (input the number in the (), for multiple sensors add those numbers together ) `;


        gdxDevice.enableDefaultSensors();
        let enabledSensors = gdxDevice.sensors.filter(s => s.enabled = true);
      
        let sensorID = 2;
        
        enabledSensors.forEach(sensor => {
           output.textContent += `\n\n Sensor: ${sensor.name} units: ${sensor.unit} (${sensorID})`  ;
           sensorID = sensorID * 2;
        }); 
                
        setTimeout(function(){ 
          const channel = prompt('choose a sensor');
          output.textContent += `\n\n Selected sensors: `;
          enabledSensors =  gdxDevice._getSensorsWithMask(channel);
          enabledSensors.forEach(sensor => {
          output.textContent += `\n\n Sensor: ${sensor.name} \n units: ${sensor.unit}`;
          
          }); 
         }, 3000);
      
      } catch (err) {
        console.error(err);
      }
   
    };
    selectDeviceBtn.addEventListener('click', selectDevice);
    
  </script>
</body>
</html>